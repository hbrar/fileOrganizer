<!doctype html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <script src='vendor/jquery-1.11.3.min.js' type='text/javascript'></script>

</head>
<body>
<h1>Hello world!</h1>
<button id='button'>click</button>
<input type="file" nwdirectory id='fileBrowser'/>
<input type="textbox" id='displaypath'/>
<script>
//npm install --save fs-extra
var fse = require('fs-extra');
var path = require('path');

$('#button').click(function(){
  var loc = $('#fileBrowser').val();
  $('#displaypath').val(loc);
var source = loc;

//the LOC below gets executed before the "list" gets copied to listOfFiles if you use asynch readdir
var listOfFiles = fse.readdirSync(source);

listOfFiles = listOfFiles.filter(function(element,index,array){
  //filtering out folders i.e extentions as undefined
  if(element.split('.')[1] !== undefined)
  return true;
});
// listOfFiles.forEach(function(element, index, array){
//   console.log(element.split(".")[1])});
listOfFiles.forEach(function(element, index, array){

  var ext = element.split(".")[1].toLowerCase();
  var origin = path.join(source,element);

  switch (ext) {
    case 'txt':
    case 'pdf':
    case 'doc':
    case 'oxps':
    case 'pub':
    case 'docx':
    case 'pages':
    case 'pptx':
    case 'ppt':
    case 'indd':
    case 'epub':
    case 'pez':
    case 'snb':
    case 'mso':
    case 'lic':
    case 'edoc':
    case 'p65':
    case 'btw':
    case 'iwa':
    case 'spd':
    case 'rtf':
    case 'log':
    case 'csv':
    case 'pps':
    case 'dat':
    case 'xml':
    case 'html':
    case 'htm':
    case 'css':
    case 'js':
    case 'php':
    case 'xhtml':
    var dest = path.join(source,'d','doc',element);
    fse.ensureDirSync(dest, function (err) {
      if (err) console.log(err) // => null
  // dir has now been created, including the directory it is to be placed in
      fse.move(origin, dest, function (err) {
      if (err)  alert(err)
      alert('moving '+element+":success!");
    });
  });
      break;

      case 'png':
      case 'jpg':
      case 'bmp':
      case 'gif':
      case 'psd':
      case 'thm':
      case 'tif':
      case 'svg':
      var dest = path.join(source,'d','images',element);
      fse.ensureDirSync(dest, function (err) {
        if (err) console.log(err) // => null
    // dir has now been created, including the directory it is to be placed in

      fse.move(origin, dest, function (err) {
        if (err) alert(err)
        alert('moving '+element+":success!");
      });
    });
        break;

        case 'aif':
        case 'iff':
        case 'm3u':
        case 'm4a':
        case 'mid':
        case 'mid':
        case 'mp3':
        case 'mpa':
        case 'ra':
        case 'wav':
        case 'wma':
        var dest = path.join(source,'d','audio',element);
        fse.ensureDirSync(dest, function (err) {
          if (err) console.log(err) // => null
      // dir has now been created, including the directory it is to be placed in

        fse.move(origin, dest, function (err) {
          if (err) alert(err)
          alert('moving '+element+":success!");
        });
      });
          break;


    default:
      alert('moving '+element+':unsuccesfull');
  }
});


})

</script>
</body>
</html>
